const z=new TextEncoder,L=new TextDecoder;let h=null;function m(t){return crypto.getRandomValues(new Uint8Array(t))}function w(t){return btoa(String.fromCharCode(...t))}function p(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))}async function M(t,e){const n=await crypto.subtle.importKey("raw",z.encode(t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:31e4,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function C(){if(h)return h;const t=chrome.runtime.id||"azkura-auth",e=navigator.userAgent||"unknown",n=`${screen.width}x${screen.height}`,a=`${t}:${e}:${n}:azkura-default-key-v1`,o=new TextEncoder().encode(a),r=await crypto.subtle.digest("SHA-256",o),f=Array.from(new Uint8Array(r));return h=btoa(String.fromCharCode(...f)),h}async function S(t,e){const n=e||await C(),a=m(16),c=m(12),o=await M(n,a),r=await crypto.subtle.encrypt({name:"AES-GCM",iv:c},o,z.encode(t));return{salt:w(a),iv:w(c),ciphertext:w(new Uint8Array(r)),version:1}}async function k(t,e){const n=e||await C(),a=p(t.salt),c=p(t.iv),o=p(t.ciphertext),r=await M(n,a);try{const f=await crypto.subtle.decrypt({name:"AES-GCM",iv:c},r,o);return L.decode(f)}catch{throw new Error("Incorrect PIN/password or corrupted data")}}async function B(t,e){const n=await crypto.subtle.importKey("raw",z.encode(t),"PBKDF2",!1,["deriveBits"]),a=await crypto.subtle.deriveBits({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},n,256);return w(new Uint8Array(a))}async function c2(t,e,n){const a=p(n);return await B(t,a)===e}async function o2(t){const e=m(16);return{hash:await B(t,e),salt:w(e)}}async function v(t){return new Promise(e=>{chrome.storage.local.get(t,n=>e(n[t]))})}async function D(t,e){return new Promise(n=>{chrome.storage.local.set({[t]:e},n)})}async function r2(t){return new Promise(e=>{chrome.storage.local.remove(t,e)})}async function O(){return new Promise(t=>{chrome.storage.local.clear(t)})}async function g(t){return new Promise(e=>{chrome.storage.session.get(t,n=>e(n[t]))})}async function b(t,e){return new Promise(n=>{chrome.storage.session.set({[t]:e},n)})}async function E(){return new Promise(t=>{chrome.storage.session.clear(t)})}async function P(t){return new Promise(e=>{chrome.storage.sync.get(t,n=>e(n[t]))})}async function F(t,e){return new Promise(n=>{chrome.storage.sync.set({[t]:e},n)})}async function K(){return!!await v("pinData")}async function s2(){const t=await P("pinEnabled");return t===void 0?await K():t}async function i2(t){return F("pinEnabled",t)}async function l2(){const t=await g("accounts");return Array.isArray(t)}async function u2(){const t=await v("pinData"),e=await v("vault");return!t&&!e}async function I(){return g("accounts")}async function l(t){return b("accounts",t)}async function f2(){const t={accentColor:"#00E5FF",autoLockMinutes:5,privacyMode:!1,compactLayout:!1,closeAfterCopy:!0,autoFocusSearch:!0,pinEnabled:!0},e=await new Promise(n=>{chrome.storage.sync.get(Object.keys(t),a=>n(a))});return{...t,...e}}async function d2(t,e){return F(t,e)}async function H(){return await P("folders")||[]}async function V(t){return F("folders",t)}async function w2(t,e="#00E5FF"){const n=await H(),a={id:"folder_"+Date.now(),name:t.trim(),color:e};return n.push(a),await V(n),a}async function h2(t){const n=(await H()).filter(c=>c.id!==t);await V(n);const a=await g("accounts")||[];a.forEach(c=>{c.folderId===t&&delete c.folderId}),await b("accounts",a)}async function p2(t,e){const n=await g("accounts")||[],a=n.find(c=>c.id===t);a&&(e?a.folderId=e:delete a.folderId,await b("accounts",n))}const A={google:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>',github:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>',discord:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z" fill="#5865F2"/></svg>',microsoft:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h11.5v11.5H0V0zm12.5 0H24v11.5H12.5V0zM0 12.5h11.5V24H0V12.5zm12.5 0H24V24H12.5V12.5z" fill="#00A4EF"/></svg>',notion:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.98-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466l1.823 1.447zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046.935-.56.935-1.167V6.354c0-.606-.233-.933-.748-.887l-15.177.887c-.56.047-.747.327-.747.933zm14.337.745c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952l1.449.327s0 .84-1.168.84l-3.22.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.14c-.093-.514.28-.887.747-.933l3.22-.187zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.933.653.933 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.84.374-1.54 1.448-1.632z" fill="#fff"/></svg>',twitter:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" fill="#fff"/></svg>',facebook:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" fill="#1877F2"/></svg>',instagram:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z" fill="#E1306C"/></svg>',linkedin:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" fill="#0A66C2"/></svg>',aws:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.863.279a2.1 2.1 0 0 1-.272.103.49.49 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167c.279-.144.614-.264 1.005-.36a4.844.844 0 0 1 1.246-.024c.6.135 1.037.407 1.307.815.28.4.415.974.415 1.71v2.257zm-3.224 1.064c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.503.128-.152.223-.32.272-.503.048-.184.08-.399.08-.647v-.311a6.604 6.604 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.919 0 .375.095.655.295.851.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.024.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.024.32.08.063.048.12.16.151.312l1.261 5.348 1.382-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.926-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.415-.287-.806-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.16.152.454.304.87.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zM21.698 16.207c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zM22.792 14.961c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z" fill="#FF9900"/></svg>',slack:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z" fill="#4A154B"/></svg>',dropbox:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 2.308L0 6.155l6 3.848 6-3.848-6-3.847zm12 0l-6 3.847 6 3.848 6-3.848-6-3.847zM0 16.693l6 3.847 6-3.847-6-3.848-6 3.848zm18-3.848l-6 3.848 6 3.847 6-3.847-6-3.848zM6 11.54l6 3.848 6-3.848-6-3.847-6 3.847z" fill="#0061FF"/></svg>',default:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>'},N={google:"#4285F4",github:"#24292e",discord:"#5865F2",microsoft:"#00A4EF",notion:"#000000",twitter:"#000000",x:"#000000",facebook:"#1877F2",instagram:"#E1306C",linkedin:"#0A66C2",aws:"#FF9900",slack:"#4A154B",dropbox:"#0061FF",gitlab:"#FC6D26",bitbucket:"#0052CC",apple:"#555555",amazon:"#FF9900",reddit:"#FF4500",twitch:"#9146FF",cloudflare:"#F48120",digitalocean:"#0080FF",vercel:"#000000",netlify:"#00C7B7",firebase:"#FFCA28",docker:"#2496ED",figma:"#F24E1E",trello:"#0079BF",stripe:"#6772E5",coinbase:"#0052FF",binance:"#F0B90B",paypal:"#003087",shopify:"#96BF48",wordpress:"#21759B"};function J(t){const e=(t||"").toLowerCase();for(const[n,a]of Object.entries(A))if(e.includes(n))return{svg:a,bg:N[n]||"#555"};return{svg:A.default,bg:U(e)}}function U(t){let e=0;for(const a of t||"A")e=e*31+a.charCodeAt(0)&4294967295;return`hsl(${Math.abs(e)%360}, 60%, 40%)`}function $(t){const e=J(t),n=e.svg!==A.default;return{bg:e.bg,letter:(t||"?").charAt(0).toUpperCase(),emoji:n?null:"ðŸ“±",hasLogo:n,svg:e.svg}}function y(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function j(t){return $(t)}async function _(t){const e=await v("vault");if(!e)return await l([]),[];const n=await k(e,t),a=JSON.parse(n);return await l(a),a}async function u(t){const e=await I();if(!e)return;const n=JSON.stringify(e),a=await S(n,t);await D("vault",a)}async function T(){await E()}async function s(){return await I()||[]}async function G(t,e){const n=await s(),a={id:y(),issuer:t.issuer||"",account:t.account||"",secret:t.secret.replace(/\s/g,"").toUpperCase(),algorithm:t.algorithm||"SHA1",digits:t.digits||6,period:t.period||30,createdAt:Date.now()};return n.push(a),await l(n),await u(e),a}async function R(t,e,n){const a=await s(),c=a.findIndex(o=>o.id===t);if(c===-1)throw new Error("Account not found");return a[c]={...a[c],...e,id:t,updatedAt:Date.now()},e.secret&&(a[c].secret=e.secret.replace(/\s/g,"").toUpperCase()),await l(a),await u(n),a[c]}async function q(t,e){const a=(await s()).filter(c=>c.id!==t);await l(a),await u(e)}async function Q(t,e){const n=await s(),a=Object.fromEntries(n.map(o=>[o.id,o])),c=t.map(o=>a[o]).filter(Boolean);await l(c),await u(e)}async function W(t){const e=await s();if(!t||!t.trim())return e;const n=t.toLowerCase();return e.filter(a=>(a.issuer||"").toLowerCase().includes(n)||(a.account||"").toLowerCase().includes(n))}async function X(t){const e=await s(),n=JSON.stringify(e),a=await S(n,t),c={app:"azkura-auth",version:"1.0.0",exportedAt:new Date().toISOString(),accountCount:e.length,encrypted:a};return JSON.stringify(c,null,2)}async function Y(){const t=await s(),e={app:"azkura-auth",version:"1.0.0",exportedAt:new Date().toISOString(),accountCount:t.length,accounts:t};return JSON.stringify(e,null,2)}async function Z(t,e,n){let a;try{a=JSON.parse(t)}catch{throw new Error("Invalid backup file: not valid JSON")}if(a.app!=="azkura-auth")throw new Error("Invalid backup file: not an Azkura Auth backup");const c=await k(a.encrypted,e),o=JSON.parse(c);if(!Array.isArray(o))throw new Error("Invalid backup: corrupted account data");const r=await s(),f=new Set(r.map(d=>d.secret+d.account)),i=o.filter(d=>!f.has(d.secret+d.account)),x=[...r,...i.map(d=>({...d,id:y()}))];return await l(x),await u(n),{imported:i.length,total:x.length}}async function t2(t,e){let n;try{n=JSON.parse(t)}catch{throw new Error("Invalid backup file: not valid JSON")}if(n.app!=="azkura-auth")throw new Error("Invalid backup file: not an Azkura Auth backup");if(!n.accounts||!Array.isArray(n.accounts))throw new Error("Invalid backup: no accounts data found");const a=n.accounts,c=await s(),o=new Set(c.map(i=>i.secret+i.account)),r=a.filter(i=>!o.has(i.secret+i.account)),f=[...c,...r.map(i=>({...i,id:y()}))];return await l(f),await u(e),{imported:r.length,total:f.length}}async function e2(t,e){if(!Array.isArray(t))throw new Error("Invalid backup: accounts data is not an array");const n=await s(),a=new Set(n.map(r=>r.secret+r.account)),c=t.filter(r=>!a.has(r.secret+r.account)),o=[...n,...c.map(r=>({...r,id:y()}))];return await l(o),await u(e),{imported:c.length,total:o.length}}async function n2(t){await l([]),await u(t)}async function a2(){await O(),await E()}const v2=Object.freeze(Object.defineProperty({__proto__:null,addAccount:G,deleteAccount:q,deleteAllAccounts:n2,exportBackup:X,exportPlainBackup:Y,getAccounts:s,getDefaultKey:C,getServiceMeta:j,importBackup:Z,importPlainBackup:t2,lockVault:T,reorderAccounts:Q,restoreFromDriveBackup:e2,saveVault:u,searchAccounts:W,unlockVault:_,updateAccount:R,wipeAllData:a2},Symbol.toStringTag,{value:"Module"}));export{H as A,j as B,C,e2 as D,h2 as E,p2 as F,v2 as G,K as a,s2 as b,l2 as c,i2 as d,W as e,G as f,v as g,s as h,u2 as i,R as j,q as k,d2 as l,T as m,I as n,o2 as o,S as p,Y as q,r2 as r,D as s,t2 as t,_ as u,c2 as v,Z as w,a2 as x,w2 as y,f2 as z};
