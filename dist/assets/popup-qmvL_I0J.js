import"./modulepreload-polyfill-B5Qt9EMX.js";const Qt=e=>{const t=new ArrayBuffer(8),n=new Uint8Array(t);let s=e;for(let r=7;r>=0&&s!==0;r--)n[r]=s&255,s-=n[r],s/=256;return n};function Yt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ie(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function re(e,t,n=""){const s=Yt(e),r=e?.length,o=t!==void 0;if(!s||o&&r!==t){const a=n&&`"${n}" `,c=o?` of length ${t}`:"",l=s?`length=${r}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+c+", got "+l)}return e}function Zt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Ie(e.outputLen),Ie(e.blockLen)}function oe(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function kt(e,t){re(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function en(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function P(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Ve(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function F(e,t){return e<<32-t|e>>>t}function Ge(e,t){return e<<t|e>>>32-t>>>0}const tn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function nn(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function sn(e){for(let t=0;t<e.length;t++)e[t]=nn(e[t]);return e}const ut=tn?e=>e:sn;function ae(e,t={}){const n=(r,o)=>e(o).update(r).digest(),s=e(void 0);return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=r=>e(r),Object.assign(n,t),Object.freeze(n)}const q=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});class Ct{update(t){return oe(this),this.iHash.update(t),this}digestInto(t){oe(this),re(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:s,finished:r,destroyed:o,blockLen:a,outputLen:c}=this;return t=t,t.finished=r,t.destroyed=o,t.blockLen=a,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=s._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}constructor(t,n){if(this.finished=!1,this.destroyed=!1,Zt(t),re(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,r=new Uint8Array(s);r.set(n.length>s?t.create().update(n).digest():n);for(let o=0;o<r.length;o++)r[o]^=54;this.iHash.update(r),this.oHash=t.create();for(let o=0;o<r.length;o++)r[o]^=106;this.oHash.update(r),P(r)}}const je=(e,t,n)=>new Ct(e,t).update(n).digest();je.create=(e,t)=>new Ct(e,t);function St(e,t,n){return e&t^~e&n}function It(e,t,n){return e&t^e&n^t&n}class Xe{update(t){oe(this),re(t);const{view:n,buffer:s,blockLen:r}=this,o=t.length;for(let a=0;a<o;){const c=Math.min(r-this.pos,o-a);if(c===r){const l=Ve(t);for(;r<=o-a;a+=r)this.process(l,a);continue}s.set(t.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===r&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){oe(this),kt(t,this),this.finished=!0;const{buffer:n,view:s,blockLen:r,isLE:o}=this;let{pos:a}=this;n[a++]=128,P(this.buffer.subarray(a)),this.padOffset>r-a&&(this.process(s,0),a=0);for(let u=a;u<r;u++)n[u]=0;s.setBigUint64(r-8,BigInt(this.length*8),o),this.process(s,0);const c=Ve(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const f=l/4,d=this.get();if(f>d.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)c.setUint32(4*u,d[u],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:s,length:r,finished:o,destroyed:a,pos:c}=this;return t.destroyed=a,t.finished=o,t.length=r,t.pos=c,r%n&&t.buffer.set(s),t}clone(){return this._cloneInto()}constructor(t,n,s,r){this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=r,this.buffer=new Uint8Array(t),this.view=Ve(this.buffer)}}const O=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),R=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),E=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),k=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),de=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),_=new Uint32Array(80);class rn extends Xe{get(){const{A:t,B:n,C:s,D:r,E:o}=this;return[t,n,s,r,o]}set(t,n,s,r,o){this.A=t|0,this.B=n|0,this.C=s|0,this.D=r|0,this.E=o|0}process(t,n){for(let l=0;l<16;l++,n+=4)_[l]=t.getUint32(n,!1);for(let l=16;l<80;l++)_[l]=Ge(_[l-3]^_[l-8]^_[l-14]^_[l-16],1);let{A:s,B:r,C:o,D:a,E:c}=this;for(let l=0;l<80;l++){let f,d;l<20?(f=St(r,o,a),d=1518500249):l<40?(f=r^o^a,d=1859775393):l<60?(f=It(r,o,a),d=2400959708):(f=r^o^a,d=3395469782);const u=Ge(s,5)+f+c+d+_[l]|0;c=a,a=o,o=Ge(r,30),r=s,s=u}s=s+this.A|0,r=r+this.B|0,o=o+this.C|0,a=a+this.D|0,c=c+this.E|0,this.set(s,r,o,a,c)}roundClean(){P(_)}destroy(){this.set(0,0,0,0,0),P(this.buffer)}constructor(){super(64,20,8,!1),this.A=de[0]|0,this.B=de[1]|0,this.C=de[2]|0,this.D=de[3]|0,this.E=de[4]|0}}const on=ae(()=>new rn),xe=BigInt(2**32-1),ft=BigInt(32);function an(e,t=!1){return t?{h:Number(e&xe),l:Number(e>>ft&xe)}:{h:Number(e>>ft&xe)|0,l:Number(e&xe)|0}}function Ht(e,t=!1){const n=e.length;let s=new Uint32Array(n),r=new Uint32Array(n);for(let o=0;o<n;o++){const{h:a,l:c}=an(e[o],t);[s[o],r[o]]=[a,c]}return[s,r]}const ht=(e,t,n)=>e>>>n,pt=(e,t,n)=>e<<32-n|t>>>n,ee=(e,t,n)=>e>>>n|t<<32-n,te=(e,t,n)=>e<<32-n|t>>>n,Le=(e,t,n)=>e<<64-n|t>>>n-32,Ae=(e,t,n)=>e>>>n-32|t<<64-n,cn=(e,t,n)=>e<<n|t>>>32-n,ln=(e,t,n)=>t<<n|e>>>32-n,dn=(e,t,n)=>t<<n-32|e>>>64-n,un=(e,t,n)=>e<<n-32|t>>>64-n;function U(e,t,n,s){const r=(t>>>0)+(s>>>0);return{h:e+n+(r/2**32|0)|0,l:r|0}}const fn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),hn=(e,t,n,s)=>t+n+s+(e/2**32|0)|0,pn=(e,t,n,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),gn=(e,t,n,s,r)=>t+n+s+r+(e/2**32|0)|0,mn=(e,t,n,s,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0)+(r>>>0),bn=(e,t,n,s,r,o)=>t+n+s+r+o+(e/2**32|0)|0,vn=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),V=new Uint32Array(64);class Dt extends Xe{get(){const{A:t,B:n,C:s,D:r,E:o,F:a,G:c,H:l}=this;return[t,n,s,r,o,a,c,l]}set(t,n,s,r,o,a,c,l){this.A=t|0,this.B=n|0,this.C=s|0,this.D=r|0,this.E=o|0,this.F=a|0,this.G=c|0,this.H=l|0}process(t,n){for(let u=0;u<16;u++,n+=4)V[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){const g=V[u-15],m=V[u-2],v=F(g,7)^F(g,18)^g>>>3,x=F(m,17)^F(m,19)^m>>>10;V[u]=x+V[u-7]+v+V[u-16]|0}let{A:s,B:r,C:o,D:a,E:c,F:l,G:f,H:d}=this;for(let u=0;u<64;u++){const g=F(c,6)^F(c,11)^F(c,25),m=d+g+St(c,l,f)+vn[u]+V[u]|0,x=(F(s,2)^F(s,13)^F(s,22))+It(s,r,o)|0;d=f,f=l,l=c,c=a+m|0,a=o,o=r,r=s,s=m+x|0}s=s+this.A|0,r=r+this.B|0,o=o+this.C|0,a=a+this.D|0,c=c+this.E|0,l=l+this.F|0,f=f+this.G|0,d=d+this.H|0,this.set(s,r,o,a,c,l,f,d)}roundClean(){P(V)}destroy(){this.set(0,0,0,0,0,0,0,0),P(this.buffer)}constructor(t){super(64,t,8,!1)}}class wn extends Dt{constructor(){super(32),this.A=O[0]|0,this.B=O[1]|0,this.C=O[2]|0,this.D=O[3]|0,this.E=O[4]|0,this.F=O[5]|0,this.G=O[6]|0,this.H=O[7]|0}}class yn extends Dt{constructor(){super(28),this.A=R[0]|0,this.B=R[1]|0,this.C=R[2]|0,this.D=R[3]|0,this.E=R[4]|0,this.F=R[5]|0,this.G=R[6]|0,this.H=R[7]|0}}const Mt=Ht(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),xn=Mt[0],Ln=Mt[1],G=new Uint32Array(80),j=new Uint32Array(80);class Ft extends Xe{get(){const{Ah:t,Al:n,Bh:s,Bl:r,Ch:o,Cl:a,Dh:c,Dl:l,Eh:f,El:d,Fh:u,Fl:g,Gh:m,Gl:v,Hh:x,Hl:M}=this;return[t,n,s,r,o,a,c,l,f,d,u,g,m,v,x,M]}set(t,n,s,r,o,a,c,l,f,d,u,g,m,v,x,M){this.Ah=t|0,this.Al=n|0,this.Bh=s|0,this.Bl=r|0,this.Ch=o|0,this.Cl=a|0,this.Dh=c|0,this.Dl=l|0,this.Eh=f|0,this.El=d|0,this.Fh=u|0,this.Fl=g|0,this.Gh=m|0,this.Gl=v|0,this.Hh=x|0,this.Hl=M|0}process(t,n){for(let w=0;w<16;w++,n+=4)G[w]=t.getUint32(n),j[w]=t.getUint32(n+=4);for(let w=16;w<80;w++){const z=G[w-15]|0,N=j[w-15]|0,Ne=ee(z,N,1)^ee(z,N,8)^ht(z,N,7),Oe=te(z,N,1)^te(z,N,8)^pt(z,N,7),$=G[w-2]|0,T=j[w-2]|0,we=ee($,T,19)^Le($,T,61)^ht($,T,6),Re=te($,T,19)^Ae($,T,61)^pt($,T,6),ye=pn(Oe,Re,j[w-7],j[w-16]),_e=gn(ye,Ne,we,G[w-7],G[w-16]);G[w]=_e|0,j[w]=ye|0}let{Ah:s,Al:r,Bh:o,Bl:a,Ch:c,Cl:l,Dh:f,Dl:d,Eh:u,El:g,Fh:m,Fl:v,Gh:x,Gl:M,Hh:ce,Hl:le}=this;for(let w=0;w<80;w++){const z=ee(u,g,14)^ee(u,g,18)^Le(u,g,41),N=te(u,g,14)^te(u,g,18)^Ae(u,g,41),Ne=u&m^~u&x,Oe=g&v^~g&M,$=mn(le,N,Oe,Ln[w],j[w]),T=bn($,ce,z,Ne,xn[w],G[w]),we=$|0,Re=ee(s,r,28)^Le(s,r,34)^Le(s,r,39),ye=te(s,r,28)^Ae(s,r,34)^Ae(s,r,39),_e=s&o^s&c^o&c,Xt=r&a^r&l^a&l;ce=x|0,le=M|0,x=m|0,M=v|0,m=u|0,v=g|0,{h:u,l:g}=U(f|0,d|0,T|0,we|0),f=c|0,d=l|0,c=o|0,l=a|0,o=s|0,a=r|0;const dt=fn(we,ye,Xt);s=hn(dt,T,Re,_e),r=dt|0}({h:s,l:r}=U(this.Ah|0,this.Al|0,s|0,r|0)),{h:o,l:a}=U(this.Bh|0,this.Bl|0,o|0,a|0),{h:c,l}=U(this.Ch|0,this.Cl|0,c|0,l|0),{h:f,l:d}=U(this.Dh|0,this.Dl|0,f|0,d|0),{h:u,l:g}=U(this.Eh|0,this.El|0,u|0,g|0),{h:m,l:v}=U(this.Fh|0,this.Fl|0,m|0,v|0),{h:x,l:M}=U(this.Gh|0,this.Gl|0,x|0,M|0),{h:ce,l:le}=U(this.Hh|0,this.Hl|0,ce|0,le|0),this.set(s,r,o,a,c,l,f,d,u,g,m,v,x,M,ce,le)}roundClean(){P(G,j)}destroy(){P(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}constructor(t){super(128,t,16,!1)}}class An extends Ft{constructor(){super(64),this.Ah=k[0]|0,this.Al=k[1]|0,this.Bh=k[2]|0,this.Bl=k[3]|0,this.Ch=k[4]|0,this.Cl=k[5]|0,this.Dh=k[6]|0,this.Dl=k[7]|0,this.Eh=k[8]|0,this.El=k[9]|0,this.Fh=k[10]|0,this.Fl=k[11]|0,this.Gh=k[12]|0,this.Gl=k[13]|0,this.Hh=k[14]|0,this.Hl=k[15]|0}}class En extends Ft{constructor(){super(48),this.Ah=E[0]|0,this.Al=E[1]|0,this.Bh=E[2]|0,this.Bl=E[3]|0,this.Ch=E[4]|0,this.Cl=E[5]|0,this.Dh=E[6]|0,this.Dl=E[7]|0,this.Eh=E[8]|0,this.El=E[9]|0,this.Fh=E[10]|0,this.Fl=E[11]|0,this.Gh=E[12]|0,this.Gl=E[13]|0,this.Hh=E[14]|0,this.Hl=E[15]|0}}const kn=ae(()=>new wn,q(1)),Cn=ae(()=>new yn,q(4)),Sn=ae(()=>new An,q(3)),In=ae(()=>new En,q(2)),Hn=BigInt(0),ue=BigInt(1),Dn=BigInt(2),Mn=BigInt(7),Fn=BigInt(256),Bn=BigInt(113),Bt=[],Pt=[],$t=[];for(let e=0,t=ue,n=1,s=0;e<24;e++){[n,s]=[s,(2*n+3*s)%5],Bt.push(2*(5*s+n)),Pt.push((e+1)*(e+2)/2%64);let r=Hn;for(let o=0;o<7;o++)t=(t<<ue^(t>>Mn)*Bn)%Fn,t&Dn&&(r^=ue<<(ue<<BigInt(o))-ue);$t.push(r)}const Tt=Ht($t,!0),Pn=Tt[0],$n=Tt[1],gt=(e,t,n)=>n>32?dn(e,t,n):cn(e,t,n),mt=(e,t,n)=>n>32?un(e,t,n):ln(e,t,n);function Tn(e,t=24){const n=new Uint32Array(10);for(let s=24-t;s<24;s++){for(let a=0;a<10;a++)n[a]=e[a]^e[a+10]^e[a+20]^e[a+30]^e[a+40];for(let a=0;a<10;a+=2){const c=(a+8)%10,l=(a+2)%10,f=n[l],d=n[l+1],u=gt(f,d,1)^n[c],g=mt(f,d,1)^n[c+1];for(let m=0;m<50;m+=10)e[a+m]^=u,e[a+m+1]^=g}let r=e[2],o=e[3];for(let a=0;a<24;a++){const c=Pt[a],l=gt(r,o,c),f=mt(r,o,c),d=Bt[a];r=e[d],o=e[d+1],e[d]=l,e[d+1]=f}for(let a=0;a<50;a+=10){for(let c=0;c<10;c++)n[c]=e[a+c];for(let c=0;c<10;c++)e[a+c]^=~n[(c+2)%10]&n[(c+4)%10]}e[0]^=Pn[s],e[1]^=$n[s]}P(n)}class Qe{clone(){return this._cloneInto()}keccak(){ut(this.state32),Tn(this.state32,this.rounds),ut(this.state32),this.posOut=0,this.pos=0}update(t){oe(this),re(t);const{blockLen:n,state:s}=this,r=t.length;for(let o=0;o<r;){const a=Math.min(n-this.pos,r-o);for(let c=0;c<a;c++)s[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:s,blockLen:r}=this;t[s]^=n,(n&128)!==0&&s===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){oe(this,!1),re(t),this.finish();const n=this.state,{blockLen:s}=this;for(let r=0,o=t.length;r<o;){this.posOut>=s&&this.keccak();const a=Math.min(s-this.posOut,o-r);t.set(n.subarray(this.posOut,this.posOut+a),r),this.posOut+=a,r+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Ie(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(kt(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,P(this.state)}_cloneInto(t){const{blockLen:n,suffix:s,outputLen:r,rounds:o,enableXOF:a}=this;return t||(t=new Qe(n,s,r,a,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=s,t.outputLen=r,t.enableXOF=a,t.destroyed=this.destroyed,t}constructor(t,n,s,r=!1,o=24){if(this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=s,this.enableXOF=r,this.rounds=o,Ie(s,"outputLen"),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=en(this.state)}}const Be=(e,t,n,s={})=>ae(()=>new Qe(t,e,n),s),Un=Be(6,144,28,q(7)),zn=Be(6,136,32,q(8)),Nn=Be(6,104,48,q(9)),On=Be(6,72,64,q(10)),ie=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__<"u")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global})(),bt={SHA1:on,SHA224:Cn,SHA256:kn,SHA384:In,SHA512:Sn,"SHA3-224":Un,"SHA3-256":zn,"SHA3-384":Nn,"SHA3-512":On},Ye=e=>{switch(!0){case/^(?:SHA-?1|SSL3-SHA1)$/i.test(e):return"SHA1";case/^SHA(?:2?-)?224$/i.test(e):return"SHA224";case/^SHA(?:2?-)?256$/i.test(e):return"SHA256";case/^SHA(?:2?-)?384$/i.test(e):return"SHA384";case/^SHA(?:2?-)?512$/i.test(e):return"SHA512";case/^SHA3-224$/i.test(e):return"SHA3-224";case/^SHA3-256$/i.test(e):return"SHA3-256";case/^SHA3-384$/i.test(e):return"SHA3-384";case/^SHA3-512$/i.test(e):return"SHA3-512";default:throw new TypeError(`Unknown hash algorithm: ${e}`)}},vt=(e,t,n)=>{if(je){const s=bt[e]??bt[Ye(e)];return je(s,t,n)}else throw new Error("Missing HMAC function")},Ke="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",Rn=e=>{e=e.replace(/ /g,"");let t=e.length;for(;e[t-1]==="=";)--t;e=(t<e.length?e.substring(0,t):e).toUpperCase();const n=new ArrayBuffer(e.length*5/8|0),s=new Uint8Array(n);let r=0,o=0,a=0;for(let c=0;c<e.length;c++){const l=Ke.indexOf(e[c]);if(l===-1)throw new TypeError(`Invalid character found: ${e[c]}`);o=o<<5|l,r+=5,r>=8&&(r-=8,s[a++]=o>>>r)}return s},_n=e=>{let t=0,n=0,s="";for(let r=0;r<e.length;r++)for(n=n<<8|e[r],t+=8;t>=5;)s+=Ke[n>>>t-5&31],t-=5;return t>0&&(s+=Ke[n<<5-t&31]),s},Vn=e=>{e=e.replace(/ /g,"");const t=new ArrayBuffer(e.length/2),n=new Uint8Array(t);for(let s=0;s<e.length;s+=2)n[s/2]=parseInt(e.substring(s,s+2),16);return n},Gn=e=>{let t="";for(let n=0;n<e.length;n++){const s=e[n].toString(16);s.length===1&&(t+="0"),t+=s}return t.toUpperCase()},jn=e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s)&255;return n},Kn=e=>{let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},wt=ie.TextEncoder?new ie.TextEncoder:null,yt=ie.TextDecoder?new ie.TextDecoder:null,Wn=e=>{if(!wt)throw new Error("Encoding API not available");return wt.encode(e)},Jn=e=>{if(!yt)throw new Error("Encoding API not available");return yt.decode(e)},qn=e=>{if(ie.crypto?.getRandomValues)return ie.crypto.getRandomValues(new Uint8Array(e));throw new Error("Cryptography API not available")};class B{static fromLatin1(t){return new B({buffer:jn(t).buffer})}static fromUTF8(t){return new B({buffer:Wn(t).buffer})}static fromBase32(t){return new B({buffer:Rn(t).buffer})}static fromHex(t){return new B({buffer:Vn(t).buffer})}get buffer(){return this.bytes.buffer}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,writable:!1,configurable:!1,value:Kn(this.bytes)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,writable:!1,configurable:!1,value:Jn(this.bytes)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,writable:!1,configurable:!1,value:_n(this.bytes)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,writable:!1,configurable:!1,value:Gn(this.bytes)}),this.hex}constructor({buffer:t,size:n=20}={}){this.bytes=typeof t>"u"?qn(n):new Uint8Array(t),Object.defineProperty(this,"bytes",{enumerable:!0,writable:!1,configurable:!1,value:this.bytes})}}const Xn=(e,t)=>{{if(e.length!==t.length)throw new TypeError("Input strings must have the same length");let n=-1,s=0;for(;++n<e.length;)s|=e.charCodeAt(n)^t.charCodeAt(n);return s===0}};class A{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,counter:0,window:1}}static generate({secret:t,algorithm:n=A.defaults.algorithm,digits:s=A.defaults.digits,counter:r=A.defaults.counter,hmac:o=vt}){const a=Qt(r),c=o(n,t.bytes,a);if(!c?.byteLength||c.byteLength<19)throw new TypeError("Return value must be at least 19 bytes");const l=c[c.byteLength-1]&15;return(((c[l]&127)<<24|(c[l+1]&255)<<16|(c[l+2]&255)<<8|c[l+3]&255)%10**s).toString().padStart(s,"0")}generate({counter:t=this.counter++}={}){return A.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:t,hmac:this.hmac})}static validate({token:t,secret:n,algorithm:s,digits:r=A.defaults.digits,counter:o=A.defaults.counter,window:a=A.defaults.window,hmac:c=vt}){if(t.length!==r)return null;let l=null;const f=d=>{const u=A.generate({secret:n,algorithm:s,digits:r,counter:d,hmac:c});Xn(t,u)&&(l=d-o)};f(o);for(let d=1;d<=a&&l===null&&(f(o-d),!(l!==null||(f(o+d),l!==null)));++d);return l}validate({token:t,counter:n=this.counter,window:s}){return A.validate({token:t,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:n,window:s,hmac:this.hmac})}toString(){const t=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?this.issuerInLabel?`${t(this.issuer)}:${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?`}secret=${t(this.secret.base32)}&algorithm=${t(this.algorithm)}&digits=${t(this.digits)}&counter=${t(this.counter)}`}constructor({issuer:t=A.defaults.issuer,label:n=A.defaults.label,issuerInLabel:s=A.defaults.issuerInLabel,secret:r=new B,algorithm:o=A.defaults.algorithm,digits:a=A.defaults.digits,counter:c=A.defaults.counter,hmac:l}={}){this.issuer=t,this.label=n,this.issuerInLabel=s,this.secret=typeof r=="string"?B.fromBase32(r):r,this.algorithm=l?o:Ye(o),this.digits=a,this.counter=c,this.hmac=l}}class L{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,period:30,window:1}}static counter({period:t=L.defaults.period,timestamp:n=Date.now()}={}){return Math.floor(n/1e3/t)}counter({timestamp:t=Date.now()}={}){return L.counter({period:this.period,timestamp:t})}static remaining({period:t=L.defaults.period,timestamp:n=Date.now()}={}){return t*1e3-n%(t*1e3)}remaining({timestamp:t=Date.now()}={}){return L.remaining({period:this.period,timestamp:t})}static generate({secret:t,algorithm:n,digits:s,period:r=L.defaults.period,timestamp:o=Date.now(),hmac:a}){return A.generate({secret:t,algorithm:n,digits:s,counter:L.counter({period:r,timestamp:o}),hmac:a})}generate({timestamp:t=Date.now()}={}){return L.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:t,hmac:this.hmac})}static validate({token:t,secret:n,algorithm:s,digits:r,period:o=L.defaults.period,timestamp:a=Date.now(),window:c,hmac:l}){return A.validate({token:t,secret:n,algorithm:s,digits:r,counter:L.counter({period:o,timestamp:a}),window:c,hmac:l})}validate({token:t,timestamp:n,window:s}){return L.validate({token:t,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:n,window:s,hmac:this.hmac})}toString(){const t=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?this.issuerInLabel?`${t(this.issuer)}:${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?`}secret=${t(this.secret.base32)}&algorithm=${t(this.algorithm)}&digits=${t(this.digits)}&period=${t(this.period)}`}constructor({issuer:t=L.defaults.issuer,label:n=L.defaults.label,issuerInLabel:s=L.defaults.issuerInLabel,secret:r=new B,algorithm:o=L.defaults.algorithm,digits:a=L.defaults.digits,period:c=L.defaults.period,hmac:l}={}){this.issuer=t,this.label=n,this.issuerInLabel=s,this.secret=typeof r=="string"?B.fromBase32(r):r,this.algorithm=l?o:Ye(o),this.digits=a,this.period=c,this.hmac=l}}async function Qn(e,t={}){const{digits:n=6,period:s=30,algorithm:r="SHA1"}=t,o=e.replace(/\s/g,"").toUpperCase();if(!He(o))throw new Error("Invalid Base32 secret key");try{return new L({secret:B.fromBase32(o),digits:n,period:s,algorithm:r}).generate()}catch(a){throw console.error("[TOTP] Generation error:",a),new Error("Failed to generate TOTP code: "+a.message)}}function Yn(e=30){return e-Math.floor(Date.now()/1e3)%e}function Zn(e){return e?e.length===6?`${e.slice(0,3)} ${e.slice(3)}`:e.length===8?`${e.slice(0,4)} ${e.slice(4)}`:e:"--- ---"}function He(e){if(!e||typeof e!="string")return!1;const t=e.toUpperCase().replace(/\s/g,"").replace(/=+$/,"");return/^[A-Z2-7]+$/.test(t)&&t.length>=8}const Ze=new TextEncoder,es=new TextDecoder;let Ee=null;function We(e){return crypto.getRandomValues(new Uint8Array(e))}function he(e){return btoa(String.fromCharCode(...e))}function Ce(e){return Uint8Array.from(atob(e),t=>t.charCodeAt(0))}async function Ut(e,t){const n=await crypto.subtle.importKey("raw",Ze.encode(e),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:31e4,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function et(){if(Ee)return Ee;const e=chrome.runtime.id||"azkura-auth",t=navigator.userAgent||"unknown",n=`${screen.width}x${screen.height}`,s=`${e}:${t}:${n}:azkura-default-key-v1`,o=new TextEncoder().encode(s),a=await crypto.subtle.digest("SHA-256",o),c=Array.from(new Uint8Array(a));return Ee=btoa(String.fromCharCode(...c)),Ee}async function Pe(e,t){const n=t||await et(),s=We(16),r=We(12),o=await Ut(n,s),a=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},o,Ze.encode(e));return{salt:he(s),iv:he(r),ciphertext:he(new Uint8Array(a)),version:1}}async function zt(e,t){const n=t||await et(),s=Ce(e.salt),r=Ce(e.iv),o=Ce(e.ciphertext),a=await Ut(n,s);try{const c=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},a,o);return es.decode(c)}catch{throw new Error("Incorrect PIN/password or corrupted data")}}async function Nt(e,t){const n=await crypto.subtle.importKey("raw",Ze.encode(e),"PBKDF2",!1,["deriveBits"]),s=await crypto.subtle.deriveBits({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},n,256);return he(new Uint8Array(s))}async function Ot(e,t,n){const s=Ce(n);return await Nt(e,s)===t}async function tt(e){const t=We(16);return{hash:await Nt(e,t),salt:he(t)}}function ts(e){if(!e||typeof e!="string")throw new Error("Invalid URI: must be a string");const t=e.trim();if(!t.startsWith("otpauth://"))throw new Error("Invalid URI: must start with otpauth://");let n;try{n=new URL(t)}catch{throw new Error("Invalid URI: malformed URL")}const s=n.hostname.toLowerCase();if(s!=="totp"&&s!=="hotp")throw new Error(`Unsupported OTP type: ${s}`);const r=decodeURIComponent(n.pathname.slice(1));let o="",a=r;if(r.includes(":")){const g=r.indexOf(":");o=r.slice(0,g).trim(),a=r.slice(g+1).trim()}const c=n.searchParams;c.get("issuer")&&(o=c.get("issuer"));const l=c.get("secret");if(!l)throw new Error("Invalid URI: missing secret parameter");const f=(c.get("algorithm")||"SHA1").toUpperCase(),d=parseInt(c.get("digits")||"6",10),u=parseInt(c.get("period")||"30",10);return{type:s,issuer:o||a.split("@")[1]||"Unknown",account:a,secret:l.replace(/\s/g,"").toUpperCase(),algorithm:f,digits:isNaN(d)?6:d,period:isNaN(u)?30:u}}async function D(e){return new Promise(t=>{chrome.storage.local.get(e,n=>t(n[e]))})}async function J(e,t){return new Promise(n=>{chrome.storage.local.set({[e]:t},n)})}async function xt(e){return new Promise(t=>{chrome.storage.local.remove(e,t)})}async function ns(){return new Promise(e=>{chrome.storage.local.clear(e)})}async function $e(e){return new Promise(t=>{chrome.storage.session.get(e,n=>t(n[e]))})}async function nt(e,t){return new Promise(n=>{chrome.storage.session.set({[e]:t},n)})}async function Rt(){return new Promise(e=>{chrome.storage.session.clear(e)})}async function _t(e){return new Promise(t=>{chrome.storage.sync.get(e,n=>t(n[e]))})}async function st(e,t){return new Promise(n=>{chrome.storage.sync.set({[e]:t},n)})}async function rt(){return!!await D("pinData")}async function ss(){const e=await _t("pinEnabled");return e===void 0?await rt():e}async function De(e){return st("pinEnabled",e)}async function rs(){const e=await $e("accounts");return Array.isArray(e)}async function os(){const e=await D("pinData"),t=await D("vault");return!e&&!t}async function Te(){return $e("accounts")}async function Y(e){return nt("accounts",e)}async function is(){const e={accentColor:"#00E5FF",autoLockMinutes:5,privacyMode:!1,compactLayout:!1,closeAfterCopy:!0,autoFocusSearch:!0,pinEnabled:!0},t=await new Promise(n=>{chrome.storage.sync.get(Object.keys(e),s=>n(s))});return{...e,...t}}async function ne(e,t){return st(e,t)}async function me(){return await _t("folders")||[]}async function Vt(e){return st("folders",e)}async function as(e,t="#00E5FF"){const n=await me(),s={id:"folder_"+Date.now(),name:e.trim(),color:t};return n.push(s),await Vt(n),s}async function cs(e){const n=(await me()).filter(r=>r.id!==e);await Vt(n);const s=await $e("accounts")||[];s.forEach(r=>{r.folderId===e&&delete r.folderId}),await nt("accounts",s)}async function Lt(e,t){const n=await $e("accounts")||[],s=n.find(r=>r.id===e);s&&(t?s.folderId=t:delete s.folderId,await nt("accounts",n))}const ls="https://www.googleapis.com/oauth2/v2/userinfo",ge="googleAuthToken",Ue="googleUserProfile";async function ot(){const e=await D(ge),t=await D(Ue);return!!(e&&t)}async function ds(){return await D(Ue)}async function ze(){return await D(ge)}async function us(){try{const e=await new Promise((n,s)=>{chrome.identity.getAuthToken({interactive:!0},r=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):r?n(r):s(new Error("No token received"))})});await J(ge,e);const t=await hs(e);if(!t)throw new Error("Failed to fetch user profile");return await J(Ue,t),{success:!0,user:t}}catch(e){return console.error("[Google Auth] Login failed:",e),{success:!1,error:e.message}}}async function fs(){try{const e=await D(ge);return e&&await new Promise(t=>{chrome.identity.removeCachedAuthToken({token:e},t)}),await xt(ge),await xt(Ue),{success:!0}}catch(e){return console.error("[Google Auth] Logout failed:",e),{success:!1,error:e.message}}}async function hs(e){try{const t=await fetch(ls,{headers:{Authorization:`Bearer ${e}`,Accept:"application/json"}});if(!t.ok)throw new Error(`HTTP ${t.status}`);const n=await t.json();return{name:n.name||"Google User",email:n.email||"",picture:n.picture||null,id:n.id||""}}catch(t){return console.error("[Google Auth] Fetch profile failed:",t),null}}const ps="https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",it="https://www.googleapis.com/drive/v3/files";async function gs(e,t=null){try{const n=await ze();if(!n)return{success:!1,error:"Not authenticated with Google"};const s=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-"),r=t||`azkura-backup-${s}.json`,o={app:"azkura-auth",version:chrome.runtime.getManifest().version,exportedAt:new Date().toISOString(),accountCount:e.length,accounts:e},a=JSON.stringify(o,null,2),c="-------314159265358979323846",l=`\r
--${c}\r
`,f=`\r
--${c}--`,d={name:r,mimeType:"application/json",description:"Azkura Auth Backup - TOTP Authenticator Data"},u=l+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(d)+l+`Content-Type: application/json\r
\r
`+a+f,g=await fetch(ps,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":`multipart/related; boundary="${c}"`},body:u});if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.error?.message||`HTTP ${g.status}`)}return{success:!0,fileId:(await g.json()).id,fileName:r}}catch(n){return console.error("[Google Drive] Upload failed:",n),{success:!1,error:n.message||"Failed to upload backup"}}}async function ms(e=10){try{const t=await ze();if(!t)return{success:!1,error:"Not authenticated with Google"};const n=encodeURIComponent("name contains 'azkura-backup' and mimeType = 'application/json' and trashed = false"),s=`${it}?q=${n}&pageSize=${e}&orderBy=createdTime desc&fields=files(id,name,createdTime,size)`,r=await fetch(s,{method:"GET",headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}`);return{success:!0,files:(await r.json()).files||[]}}catch(t){return console.error("[Google Drive] List backups failed:",t),{success:!1,error:t.message}}}async function bs(e){try{const t=await ze();if(!t)return{success:!1,error:"Not authenticated with Google"};const n=`${it}/${e}?alt=media`,s=await fetch(n,{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error(`HTTP ${s.status}`);const r=await s.text(),o=JSON.parse(r);if(o.app!=="azkura-auth"||!Array.isArray(o.accounts))throw new Error("Invalid backup file format");return{success:!0,data:o}}catch(t){return console.error("[Google Drive] Download failed:",t),{success:!1,error:t.message}}}async function vs(e){try{const t=await ze();if(!t)return{success:!1,error:"Not authenticated with Google"};const n=`${it}/${e}`,s=await fetch(n,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(!s.ok&&s.status!==204)throw new Error(`HTTP ${s.status}`);return{success:!0}}catch(t){return console.error("[Google Drive] Delete failed:",t),{success:!1,error:t.message}}}const Je={google:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>',github:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>',discord:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z" fill="#5865F2"/></svg>',microsoft:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h11.5v11.5H0V0zm12.5 0H24v11.5H12.5V0zM0 12.5h11.5V24H0V12.5zm12.5 0H24V24H12.5V12.5z" fill="#00A4EF"/></svg>',notion:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.98-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466l1.823 1.447zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046.935-.56.935-1.167V6.354c0-.606-.233-.933-.748-.887l-15.177.887c-.56.047-.747.327-.747.933zm14.337.745c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952l1.449.327s0 .84-1.168.84l-3.22.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.14c-.093-.514.28-.887.747-.933l3.22-.187zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.933.653.933 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.84.374-1.54 1.448-1.632z" fill="#fff"/></svg>',twitter:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" fill="#fff"/></svg>',facebook:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" fill="#1877F2"/></svg>',instagram:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z" fill="#E1306C"/></svg>',linkedin:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" fill="#0A66C2"/></svg>',aws:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.863.279a2.1 2.1 0 0 1-.272.103.49.49 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167c.279-.144.614-.264 1.005-.36a4.844.844 0 0 1 1.246-.024c.6.135 1.037.407 1.307.815.28.4.415.974.415 1.71v2.257zm-3.224 1.064c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.503.128-.152.223-.32.272-.503.048-.184.08-.399.08-.647v-.311a6.604 6.604 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.919 0 .375.095.655.295.851.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.024.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.024.32.08.063.048.12.16.151.312l1.261 5.348 1.382-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.926-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.415-.287-.806-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.16.152.454.304.87.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zM21.698 16.207c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zM22.792 14.961c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z" fill="#FF9900"/></svg>',slack:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z" fill="#4A154B"/></svg>',dropbox:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 2.308L0 6.155l6 3.848 6-3.848-6-3.847zm12 0l-6 3.847 6 3.848 6-3.848-6-3.847zM0 16.693l6 3.847 6-3.847-6-3.848-6 3.848zm18-3.848l-6 3.848 6 3.847 6-3.847-6-3.848zM6 11.54l6 3.848 6-3.848-6-3.847-6 3.847z" fill="#0061FF"/></svg>',default:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>'},ws={google:"#4285F4",github:"#24292e",discord:"#5865F2",microsoft:"#00A4EF",notion:"#000000",twitter:"#000000",x:"#000000",facebook:"#1877F2",instagram:"#E1306C",linkedin:"#0A66C2",aws:"#FF9900",slack:"#4A154B",dropbox:"#0061FF",gitlab:"#FC6D26",bitbucket:"#0052CC",apple:"#555555",amazon:"#FF9900",reddit:"#FF4500",twitch:"#9146FF",cloudflare:"#F48120",digitalocean:"#0080FF",vercel:"#000000",netlify:"#00C7B7",firebase:"#FFCA28",docker:"#2496ED",figma:"#F24E1E",trello:"#0079BF",stripe:"#6772E5",coinbase:"#0052FF",binance:"#F0B90B",paypal:"#003087",shopify:"#96BF48",wordpress:"#21759B"};function ys(e){const t=(e||"").toLowerCase();for(const[n,s]of Object.entries(Je))if(t.includes(n))return{svg:s,bg:ws[n]||"#555"};return{svg:Je.default,bg:xs(t)}}function xs(e){let t=0;for(const s of e||"A")t=t*31+s.charCodeAt(0)&4294967295;return`hsl(${Math.abs(t)%360}, 60%, 40%)`}function Ls(e){const t=ys(e),n=t.svg!==Je.default;return{bg:t.bg,letter:(e||"?").charAt(0).toUpperCase(),emoji:n?null:"ðŸ“±",hasLogo:n,svg:t.svg}}function at(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function As(e){return Ls(e)}async function Me(e){const t=await D("vault");if(!t)return await Y([]),[];const n=await zt(t,e),s=JSON.parse(n);return await Y(s),s}async function be(e){const t=await Te();if(!t)return;const n=JSON.stringify(t),s=await Pe(n,e);await J("vault",s)}async function Es(){await Rt()}async function C(){return await Te()||[]}async function ks(e,t){const n=await C(),s={id:at(),issuer:e.issuer||"",account:e.account||"",secret:e.secret.replace(/\s/g,"").toUpperCase(),algorithm:e.algorithm||"SHA1",digits:e.digits||6,period:e.period||30,createdAt:Date.now()};return n.push(s),await Y(n),await be(t),s}async function Cs(e,t,n){const s=await C(),r=s.findIndex(o=>o.id===e);if(r===-1)throw new Error("Account not found");return s[r]={...s[r],...t,id:e,updatedAt:Date.now()},t.secret&&(s[r].secret=t.secret.replace(/\s/g,"").toUpperCase()),await Y(s),await be(n),s[r]}async function Ss(e,t){const s=(await C()).filter(r=>r.id!==e);await Y(s),await be(t)}async function Is(e){const t=await C();if(!e||!e.trim())return t;const n=e.toLowerCase();return t.filter(s=>(s.issuer||"").toLowerCase().includes(n)||(s.account||"").toLowerCase().includes(n))}async function Hs(e){const t=await C(),n=JSON.stringify(t),s=await Pe(n,e),r={app:"azkura-auth",version:"1.0.0",exportedAt:new Date().toISOString(),accountCount:t.length,encrypted:s};return JSON.stringify(r,null,2)}async function Ds(e,t,n){let s;try{s=JSON.parse(e)}catch{throw new Error("Invalid backup file: not valid JSON")}if(s.app!=="azkura-auth")throw new Error("Invalid backup file: not an Azkura Auth backup");const r=await zt(s.encrypted,t),o=JSON.parse(r);if(!Array.isArray(o))throw new Error("Invalid backup: corrupted account data");const a=await C(),c=new Set(a.map(d=>d.secret+d.account)),l=o.filter(d=>!c.has(d.secret+d.account)),f=[...a,...l.map(d=>({...d,id:at()}))];return await Y(f),await be(n),{imported:l.length,total:f.length}}async function Ms(e,t){if(!Array.isArray(e))throw new Error("Invalid backup: accounts data is not an array");const n=await C(),s=new Set(n.map(a=>a.secret+a.account)),r=e.filter(a=>!s.has(a.secret+a.account)),o=[...n,...r.map(a=>({...a,id:at()}))];return await Y(o),await be(t),{imported:r.length,total:o.length}}async function Fs(){await ns(),await Rt()}let S=null,pe=null,y=[],b={},se=null,ke=null,X="all",Gt=[];const i=e=>document.querySelector(e),K=e=>document.querySelectorAll(e);function W(e){K(".view").forEach(t=>t.classList.remove("active")),i(e).classList.add("active")}function I(e){i(e).classList.add("open")}function p(e){i(e).classList.remove("open")}function h(e,t="info",n=2500){const s=i("#toastContainer"),r={success:"âœ“",error:"âœ•",info:"â„¹"},o=document.createElement("div");o.className=`toast ${t}`,o.innerHTML=`<span class="toast-icon">${r[t]||"â„¹"}</span><span class="toast-text">${e}</span>`,s.appendChild(o),setTimeout(()=>{o.classList.add("out"),setTimeout(()=>o.remove(),400)},n)}function qe(e,t,n,s){const r=i(`#${e}`),o=i(`#${t}`),a=s?i(`#${s}`):null;let c="";const l=6,f=["1","2","3","4","5","6","7","8","9","","0","âŒ«"],d={2:"ABC",3:"DEF",4:"GHI",5:"JKL",6:"MNO",7:"PQRS",8:"TUV",9:"WXYZ",0:"+"};r.innerHTML="",f.forEach(m=>{const v=document.createElement("button");if(v.className="pin-key",!m){v.style.visibility="hidden",r.appendChild(v);return}v.innerHTML=`<span>${m}</span>${d[m]?`<span class="pin-key-sub">${d[m]}</span>`:""}`,v.addEventListener("click",()=>{m==="âŒ«"?c=c.slice(0,-1):c.length<l&&(c+=m),u(),c.length===l&&setTimeout(()=>{n(c),c="",u()},80)}),r.appendChild(v)});function u(){o.querySelectorAll(".pin-dot").forEach((v,x)=>{v.classList.toggle("filled",x<c.length),v.classList.remove("error")}),a&&a.classList.remove("visible")}function g(m){c="",u();const v=o.querySelectorAll(".pin-dot");v.forEach(x=>x.classList.add("error")),a&&m&&(a.textContent=m,a.classList.add("visible")),setTimeout(()=>v.forEach(x=>x.classList.remove("error")),600)}return{flashError:g}}function jt(){const e=i("#onboardStep1"),t=i("#onboardStep2"),n=i("#onboardStep3");function s(o){["#step1dot","#step2dot","#step3dot"].forEach((a,c)=>{const l=i(a);l.classList.remove("active","done"),c+1===o&&l.classList.add("active"),c+1<o&&l.classList.add("done")})}i("#btnOnboardStart").addEventListener("click",()=>{e.style.display="none",t.style.display="flex",s(2)}),i("#btnBackToWelcome").addEventListener("click",()=>{t.style.display="none",e.style.display="flex",s(1),ke=null}),i("#btnSkipPin").addEventListener("click",async()=>{await De(!1),S=null,await Me(null),W("#viewMain"),await Fe(),h("PIN skipped. You can enable it later in Settings.","info",3e3)}),qe("pinKeypadCreate","pinDotsCreate",o=>{ke=o,t.style.display="none",n.style.display="flex",s(3)},"pinCreateError");const{flashError:r}=qe("pinKeypadConfirm","pinDotsConfirm",async o=>{if(o!==ke){r("PINs do not match. Try again."),ke=null,setTimeout(()=>{n.style.display="none",t.style.display="flex",s(2)},700);return}const a=await tt(o);await J("pinData",a),await De(!0),S=o,await Me(o).catch(()=>{}),s(3),W("#viewMain"),await Fe()},"pinConfirmError")}function Bs(){const{flashError:e}=qe("pinKeypadLock","pinDotsLock",async t=>{try{const n=await D("pinData");if(!await Ot(t,n.hash,n.salt)){e("Incorrect PIN. Try again.");return}S=t,await Me(t),W("#viewMain"),await Fe(),ct()}catch{e("Unlock failed. Try again.")}},"pinLockError")}function ct(){const e=b.autoLockMinutes;!e||e===0||chrome.alarms.create("auto-lock",{delayInMinutes:e})}function ve(){b.autoLockMinutes&&b.autoLockMinutes>0&&chrome.alarms.create("auto-lock",{delayInMinutes:b.autoLockMinutes})}function Q(){document.documentElement.style.setProperty("--accent",b.accentColor||"#00E5FF");const e=b.accentColor||"#00E5FF";document.documentElement.style.setProperty("--accent-dim",`${e}26`),document.documentElement.style.setProperty("--accent-dim2",`${e}14`),document.documentElement.style.setProperty("--border-accent",`${e}4D`),document.getElementById("app").classList.toggle("privacy-mode",!!b.privacyMode),document.getElementById("app").classList.toggle("layout-compact",!!b.compactLayout);const t=i("#privacyModeToggle"),n=i("#compactLayoutToggle"),s=i("#closeAfterCopyToggle"),r=i("#autoFocusSearchToggle"),o=i("#autoLockSelect"),a=i("#pinProtectionToggle");t&&(t.checked=!!b.privacyMode),n&&(n.checked=!!b.compactLayout),s&&(s.checked=b.closeAfterCopy!==!1),r&&(r.checked=b.autoFocusSearch!==!1),o&&(o.value=String(b.autoLockMinutes??5)),a&&(a.checked=!!b.pinEnabled),K("#accentColorPicker .color-swatch").forEach(c=>{c.classList.toggle("active",c.dataset.color===e)}),Ps()}function Ps(){const e=b.pinEnabled,t=i("#btnChangePIN"),n=i("#autoLockItem"),s=i("#pinDisabledWarning");t&&(t.style.display=e?"flex":"none"),n&&(n.style.display=e?"flex":"none"),s&&(s.style.display=e?"none":"flex")}function $s(e){const r=2*Math.PI*14.5,o=document.createElement("div");return o.className="progress-ring",o.innerHTML=`
    <svg width="32" height="32" viewBox="0 0 32 32">
      <circle class="progress-ring-track" cx="${32/2}" cy="${32/2}" r="${14.5}" stroke-width="3"/>
      <circle class="progress-ring-fill" cx="${32/2}" cy="${32/2}" r="${14.5}" stroke-width="3"
        stroke-dasharray="${r}" stroke-dashoffset="${r}" stroke="var(--totp-normal)"/>
    </svg>
    <div class="progress-ring-text">30</div>
  `,o._circumference=r,o._period=e,o}function Ts(e,t,n){const s=e.querySelector(".progress-ring-fill"),r=e.querySelector(".progress-ring-text"),o=e._circumference,a=t/n,c=o*(1-a);s.style.strokeDashoffset=c;let l,f;t>10?(l="var(--totp-normal)",f=""):t>5?(l="var(--totp-warning)",f="warning"):(l="var(--totp-danger)",f="danger"),s.style.stroke=l,r.textContent=t,r.className=`progress-ring-text ${f}`}function Us(e){const t=As(e.issuer),n=document.createElement("div");n.className="account-card",n.dataset.id=e.id;const s=document.createElement("div");if(s.className="service-icon",s.style.background=t.bg,t.hasLogo&&t.svg)s.innerHTML=t.svg,s.classList.add("has-logo");else if(t.emoji)s.textContent=t.emoji;else{const d=document.createElement("span");d.className="service-icon-letter",d.textContent=(e.issuer||e.account||"?")[0].toUpperCase(),s.appendChild(d)}const r=document.createElement("div");r.className="account-info",r.innerHTML=`
    <div class="account-issuer">${Z(e.issuer||"Unknown")}</div>
    <div class="account-label">${Z(e.account||"")}</div>
  `;const o=document.createElement("div");o.className="account-code-wrapper";const a=document.createElement("div");a.className="account-code",a.textContent="--- ---";const c=$s(e.period||30);o.appendChild(a),o.appendChild(c);const l=document.createElement("div");l.className="copy-flash";const f=document.createElement("div");return f.className="card-actions",f.innerHTML=`
    <button class="card-action-btn" data-action="folder" title="Move to folder">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
    </button>
    <button class="card-action-btn" data-action="edit" title="Edit">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
    </button>
    <button class="card-action-btn delete" data-action="delete" title="Delete">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
    </button>
  `,n.appendChild(s),n.appendChild(r),n.appendChild(o),n.appendChild(l),n.appendChild(f),n.addEventListener("click",d=>{d.target.closest("[data-action]")||zs(e.id,a,l,n)}),f.addEventListener("click",d=>{const u=d.target.closest("[data-action]");u&&(d.stopPropagation(),u.dataset.action==="folder"&&tr(e.id),u.dataset.action==="edit"&&Gs(e.id),u.dataset.action==="delete"&&Ks(e.id,e.issuer,e.account))}),n._codeEl=a,n._ringEl=c,n._account=e,n}function Z(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}async function zs(e,t,n,s){const r=t.textContent.replace(/\s/g,"");try{await navigator.clipboard.writeText(r),n.classList.remove("animate"),n.offsetWidth,n.classList.add("animate"),s.classList.add("copied"),setTimeout(()=>s.classList.remove("copied"),800),h("Code copied!","success",1500),ve(),b.closeAfterCopy&&setTimeout(()=>window.close(),700)}catch{h("Failed to copy","error")}}async function Fe(){b=await is(),Q(),await Jt(),await lt(),y=await C(),H(y),Ns(),b.autoFocusSearch&&setTimeout(()=>i("#searchInput")?.focus(),100),await Se()}function H(e){const t=i("#accountsList");t.innerHTML="";let n=e;if(X==="uncategorized"?n=e.filter(s=>!s.folderId):X!=="all"&&(n=e.filter(s=>s.folderId===X)),!n||n.length===0){const s=i("#searchInput")?.value||"",r=X==="all"?"":X==="uncategorized"?" in Uncategorized":" in this folder";t.innerHTML=`
      <div class="accounts-empty">
        <div class="accounts-empty-icon">${s?"ðŸ”":"ðŸ”"}</div>
        <div class="accounts-empty-title">${s?"No results":"No accounts"}</div>
        <div class="accounts-empty-sub">${s?`No accounts match "${Z(s)}"`:`No accounts${r} yet`}</div>
      </div>
    `;return}n.forEach(s=>{const r=Us(s);t.appendChild(r)}),Kt()}async function Kt(){const e=K(".account-card");for(const t of e){const n=t._account;if(!n)continue;const s=Yn(n.period||30);try{const r=await Qn(n.secret,{digits:n.digits||6,period:n.period||30,algorithm:n.algorithm||"SHA1"});t._codeEl.textContent=Zn(r),t._codeEl.classList.remove("warning","danger"),s<=5?t._codeEl.classList.add("danger"):s<=10&&t._codeEl.classList.add("warning"),Ts(t._ringEl,s,n.period||30)}catch{t._codeEl.textContent="Error"}}}function Ns(){pe&&clearInterval(pe),pe=setInterval(Kt,1e3)}function Os(){const e=i("#searchInput"),t=i("#searchClear");e.addEventListener("input",async()=>{const n=e.value.trim();t.classList.toggle("visible",n.length>0);const s=await Is(n);H(s),ve()}),t.addEventListener("click",()=>{e.value="",t.classList.remove("visible"),H(y),e.focus()})}function Rs(){const e=i("#fabBtn"),t=i("#fabMenu");e.addEventListener("click",()=>{const n=t.classList.toggle("open");e.classList.toggle("open",n)}),document.addEventListener("click",n=>{n.target.closest("#fabContainer")||(t.classList.remove("open"),e.classList.remove("open"))}),i("#btnManualEntry").addEventListener("click",()=>{t.classList.remove("open"),e.classList.remove("open"),Wt(),I("#modalAddAccount")}),i("#btnUploadQR").addEventListener("click",()=>{t.classList.remove("open"),e.classList.remove("open"),chrome.tabs.create({url:chrome.runtime.getURL("src/scanner/scanner.html?tab=upload")})}),i("#btnScanQR").addEventListener("click",()=>{t.classList.remove("open"),e.classList.remove("open"),chrome.tabs.create({url:chrome.runtime.getURL("src/scanner/scanner.html")})})}function _s(e){i("#addIssuer").value=e.issuer||"",i("#addAccount").value=e.account||"",i("#addSecret").value=e.secret||"",i("#addAlgorithm").value=e.algorithm||"SHA1",i("#addDigits").value=String(e.digits||6),i("#addPeriod").value=String(e.period||30)}function Wt(){i("#addIssuer").value="",i("#addAccount").value="",i("#addSecret").value="",i("#addAlgorithm").value="SHA1",i("#addDigits").value="6",i("#addPeriod").value="30",i("#addSecretError").classList.remove("visible")}function Vs(){i("#closeModalAdd").addEventListener("click",()=>p("#modalAddAccount")),i("#modalAddAccount").addEventListener("click",e=>{e.target===e.currentTarget&&p("#modalAddAccount")}),i("#addSecret").addEventListener("blur",()=>{const e=i("#addSecret").value,t=i("#addSecretError");e&&!He(e)?(i("#addSecret").classList.add("error"),t.classList.add("visible")):(i("#addSecret").classList.remove("error"),t.classList.remove("visible"))}),i("#btnAddAccountSubmit").addEventListener("click",async()=>{const e=i("#addIssuer").value.trim(),t=i("#addAccount").value.trim(),n=i("#addSecret").value.trim(),s=i("#addAlgorithm").value,r=parseInt(i("#addDigits").value),o=parseInt(i("#addPeriod").value);if(!n||!He(n)){i("#addSecret").classList.add("error"),i("#addSecretError").classList.add("visible");return}if(!t&&!e){h("Please enter an account name or issuer","error");return}try{i("#btnAddAccountSubmit").disabled=!0;const a=await ks({issuer:e,account:t,secret:n,algorithm:s,digits:r,period:o},S);y=await C(),H(y),p("#modalAddAccount"),Wt(),h(`${e||t} added!`,"success"),ve()}catch(a){h("Failed to add account: "+a.message,"error")}finally{i("#btnAddAccountSubmit").disabled=!1}})}function Gs(e){const t=y.find(n=>n.id===e);t&&(i("#editAccountId").value=t.id,i("#editIssuer").value=t.issuer||"",i("#editAccountName").value=t.account||"",i("#editSecret").value=t.secret||"",i("#editAlgorithm").value=t.algorithm||"SHA1",i("#editDigits").value=String(t.digits||6),I("#modalEditAccount"))}function js(){i("#closeModalEdit").addEventListener("click",()=>p("#modalEditAccount")),i("#modalEditAccount").addEventListener("click",e=>{e.target===e.currentTarget&&p("#modalEditAccount")}),i("#toggleSecretVisibility").addEventListener("click",()=>{const e=i("#editSecret");e.type=e.type==="password"?"text":"password"}),i("#btnEditAccountSubmit").addEventListener("click",async()=>{const e=i("#editAccountId").value,t=i("#editIssuer").value.trim(),n=i("#editAccountName").value.trim(),s=i("#editSecret").value.trim(),r=i("#editAlgorithm").value,o=parseInt(i("#editDigits").value);if(!s||!He(s)){h("Invalid secret key","error");return}try{i("#btnEditAccountSubmit").disabled=!0,await Cs(e,{issuer:t,account:n,secret:s,algorithm:r,digits:o},S),y=await C(),H(y),p("#modalEditAccount"),h("Account updated!","success"),ve()}catch(a){h("Failed to update: "+a.message,"error")}finally{i("#btnEditAccountSubmit").disabled=!1}})}let fe=null;function Ks(e,t,n){fe=e;const s=`Delete <strong>${Z(t||n)}</strong>? This will permanently remove the account and its TOTP secret.`;i("#deleteConfirmText").innerHTML=s,i("#deleteAccountId").value=e,I("#modalDeleteConfirm")}function Ws(){i("#btnDeleteCancel").addEventListener("click",()=>{p("#modalDeleteConfirm"),fe=null}),i("#modalDeleteConfirm").addEventListener("click",e=>{e.target===e.currentTarget&&p("#modalDeleteConfirm")}),i("#btnDeleteConfirm").addEventListener("click",async()=>{if(fe)try{await Ss(fe,S),y=await C(),H(y),p("#modalDeleteConfirm"),h("Account deleted","info"),fe=null,ve()}catch(e){h("Failed to delete: "+e.message,"error")}})}function Js(){const e=i("#btnProfile"),t=i("#profileMenuOverlay");e.addEventListener("click",()=>{t.classList.toggle("open")&&Se()}),t.addEventListener("click",n=>{n.target===t&&t.classList.remove("open")}),i("#btnLoginGoogle").addEventListener("click",async()=>{const n=await us();n.success?(h(`Welcome, ${n.user.name}!`,"success"),await Se(),t.classList.remove("open")):h("Login failed: "+n.error,"error")}),i("#btnLogoutGoogle").addEventListener("click",async()=>{(await fs()).success&&(h("Signed out","info"),await Se(),t.classList.remove("open"))}),i("#btnBackupToDrive").addEventListener("click",async()=>{t.classList.remove("open"),await At()}),i("#btnRestoreFromDriveMenu")?.addEventListener("click",async()=>{t.classList.remove("open"),await Et()}),i("#btnBackupDriveSettings")?.addEventListener("click",async()=>{p("#modalSettings"),await At()}),i("#btnRestoreDriveSettings")?.addEventListener("click",async()=>{p("#modalSettings"),await Et()}),i("#closeModalRestoreDrive")?.addEventListener("click",()=>p("#modalRestoreDrive")),i("#modalRestoreDrive")?.addEventListener("click",n=>{n.target===n.currentTarget&&p("#modalRestoreDrive")})}async function Se(){const e=i("#profileMenuLoggedOut"),t=i("#profileMenuLoggedIn"),n=i("#btnBackupDriveSettings"),s=i("#btnRestoreDriveSettings");if(await ot()){const o=await ds();if(o){i("#userDisplayName").textContent=o.name,i("#userEmail").textContent=o.email;const a=i("#userProfilePicture");o.picture?(a.src=o.picture,a.style.display="block"):a.style.display="none";const c=i("#profileAvatar");o.picture&&(c.innerHTML=`<img src="${o.picture}" alt="Profile" />`)}e.style.display="none",t.style.display="block",n&&(n.style.display="flex"),s&&(s.style.display="flex")}else e.style.display="block",t.style.display="none",n&&(n.style.display="none"),s&&(s.style.display="none"),i("#profileAvatar").innerHTML=`
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
        <circle cx="12" cy="7" r="4"/>
      </svg>
    `}async function At(){if(!await ot()){h("Please sign in with Google first","error");return}h("Backing up to Drive...","info");const e=await gs(y);e.success?h(`Backup saved: ${e.fileName}`,"success",3e3):h("Backup failed: "+e.error,"error")}async function Et(){if(!await ot()){h("Please sign in with Google first","error");return}I("#modalRestoreDrive"),i("#restoreDriveLoading").style.display="block",i("#restoreDriveEmpty").style.display="none",i("#restoreDriveList").style.display="none",i("#restoreDriveError").style.display="none",i("#restoreDriveFiles").innerHTML="";const e=await ms(10);if(i("#restoreDriveLoading").style.display="none",!e.success){i("#restoreDriveError").textContent="Failed to load backups: "+e.error,i("#restoreDriveError").style.display="block";return}const t=e.files;if(!t||t.length===0){i("#restoreDriveEmpty").style.display="block";return}i("#restoreDriveList").style.display="block";const n=i("#restoreDriveFiles");t.forEach(s=>{const r=new Date(s.createdTime).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),o=s.size?`(${(parseInt(s.size)/1024).toFixed(1)} KB)`:"",a=document.createElement("div");a.className="restore-file-item",a.innerHTML=`
      <div class="restore-file-icon">ðŸ“¦</div>
      <div class="restore-file-info">
        <div class="restore-file-name">${s.name}</div>
        <div class="restore-file-date">${r} ${o}</div>
      </div>
      <div class="restore-file-actions">
        <button class="restore-btn restore-btn-restore" title="Restore this backup">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;">
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </button>
        <button class="restore-btn restore-btn-delete" title="Delete this backup">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
          </svg>
        </button>
      </div>
    `,a.querySelector(".restore-btn-restore").addEventListener("click",c=>{c.stopPropagation(),qs(s.id,s.name)}),a.querySelector(".restore-btn-delete").addEventListener("click",c=>{c.stopPropagation(),Xs(s.id,s.name,a)}),n.appendChild(a)})}async function qs(e,t){h("Downloading backup...","info");const n=await bs(e);if(!n.success){h("Download failed: "+n.error,"error");return}p("#modalRestoreDrive");try{const s=S||await et(),r=await Ms(n.data.accounts,s);y=await C(),H(y),p("#modalSettings"),h(`Restored ${r.imported} account(s) from Drive!`,"success")}catch(s){h("Restore failed: "+s.message,"error")}}async function Xs(e,t,n){if(!confirm(`Delete backup "${t}"?`))return;h("Deleting backup...","info");const s=await vs(e);s.success?(n.style.opacity="0",n.style.transform="translateX(-20px)",setTimeout(()=>n.remove(),300),h("Backup deleted","success"),i("#restoreDriveFiles").children.length===0&&(i("#restoreDriveList").style.display="none",i("#restoreDriveEmpty").style.display="block")):h("Delete failed: "+s.error,"error")}function Qs(){i("#btnSettings").addEventListener("click",()=>{Q(),I("#modalSettings")}),i("#closeModalSettings").addEventListener("click",()=>p("#modalSettings")),i("#modalSettings").addEventListener("click",e=>{e.target===e.currentTarget&&p("#modalSettings")}),i("#pinProtectionToggle").addEventListener("change",async e=>{const t=e.target.checked;if(t&&!await rt()){p("#modalSettings"),Ys();return}b.pinEnabled=t,await De(t),Q(),h(t?"PIN protection enabled":"PIN protection disabled","info")}),i("#privacyModeToggle").addEventListener("change",async e=>{b.privacyMode=e.target.checked,await ne("privacyMode",b.privacyMode),Q()}),i("#compactLayoutToggle").addEventListener("change",async e=>{b.compactLayout=e.target.checked,await ne("compactLayout",b.compactLayout),Q()}),i("#closeAfterCopyToggle").addEventListener("change",async e=>{b.closeAfterCopy=e.target.checked,await ne("closeAfterCopy",b.closeAfterCopy)}),i("#autoFocusSearchToggle").addEventListener("change",async e=>{b.autoFocusSearch=e.target.checked,await ne("autoFocusSearch",b.autoFocusSearch)}),i("#autoLockSelect").addEventListener("change",async e=>{b.autoLockMinutes=parseInt(e.target.value),await ne("autoLockMinutes",b.autoLockMinutes),ct()}),K("#accentColorPicker .color-swatch").forEach(e=>{e.addEventListener("click",async()=>{const t=e.dataset.color;b.accentColor=t,await ne("accentColor",t),Q()})}),i("#btnLockNow").addEventListener("click",async()=>{await Es(),S=null,p("#modalSettings"),W("#viewLock"),pe&&clearInterval(pe)}),i("#btnChangePIN").addEventListener("click",()=>{i("#currentPin").value="",i("#newPin").value="",i("#confirmNewPin").value="",i("#changePinError").classList.remove("visible"),I("#modalChangePin")}),i("#closeModalChangePin").addEventListener("click",()=>p("#modalChangePin")),i("#btnChangePinConfirm").addEventListener("click",async()=>{const e=i("#currentPin").value,t=i("#newPin").value,n=i("#confirmNewPin").value,s=i("#changePinError");if(t.length<4){s.textContent="PIN must be at least 4 digits",s.classList.add("visible");return}if(t!==n){s.textContent="New PINs do not match",s.classList.add("visible");return}try{const r=await D("pinData");if(!await Ot(e,r.hash,r.salt)){s.textContent="Current PIN is incorrect",s.classList.add("visible");return}const a=await Te(),c=await tt(t);if(await J("pinData",c),a){const l=JSON.stringify(a),f=await Pe(l,t);await J("vault",f)}S=t,p("#modalChangePin"),h("PIN updated successfully!","success")}catch(r){s.textContent="Failed: "+r.message,s.classList.add("visible")}}),i("#btnExportData").addEventListener("click",()=>{i("#exportPassword").value="",i("#exportPasswordConfirm").value="",i("#exportPasswordError").classList.remove("visible"),I("#modalExportPassword")}),i("#closeModalExport").addEventListener("click",()=>p("#modalExportPassword")),i("#btnExportConfirm").addEventListener("click",async()=>{const e=i("#exportPassword").value,t=i("#exportPasswordConfirm").value,n=i("#exportPasswordError");if(!e){n.textContent="Please enter a password",n.classList.add("visible");return}if(e!==t){n.textContent="Passwords do not match",n.classList.add("visible");return}try{i("#btnExportConfirm").disabled=!0;const s=await Hs(e),r=new Blob([s],{type:"application/json"}),o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=`azkura-backup-${new Date().toISOString().slice(0,10)}.json`,a.click(),URL.revokeObjectURL(o),p("#modalExportPassword"),h("Backup exported!","success")}catch(s){n.textContent="Export failed: "+s.message,n.classList.add("visible")}finally{i("#btnExportConfirm").disabled=!1}}),i("#importFileInput").addEventListener("change",e=>{se=e.target.files[0],se&&(i("#importPassword").value="",i("#importPasswordError").classList.remove("visible"),i("#importFileInfo").textContent=`File: ${se.name}. Enter the backup password.`,I("#modalImportPassword"),e.target.value="")}),i("#closeModalImport").addEventListener("click",()=>p("#modalImportPassword")),i("#btnImportConfirm").addEventListener("click",async()=>{if(!se)return;const e=i("#importPassword").value,t=i("#importPasswordError");if(!e){t.textContent="Please enter the backup password",t.classList.add("visible");return}try{i("#btnImportConfirm").disabled=!0;const n=await se.text(),s=await Ds(n,e,S);y=await C(),H(y),p("#modalImportPassword"),p("#modalSettings"),h(`Imported ${s.imported} account(s)!`,"success"),se=null}catch(n){t.textContent=n.message,t.classList.add("visible")}finally{i("#btnImportConfirm").disabled=!1}}),i("#btnDeleteAll").addEventListener("click",()=>{i("#deleteAllConfirmInput").value="",i("#btnDeleteAllConfirm").disabled=!0,I("#modalDeleteAll")}),i("#btnDeleteAllCancel").addEventListener("click",()=>p("#modalDeleteAll")),i("#deleteAllConfirmInput").addEventListener("input",e=>{i("#btnDeleteAllConfirm").disabled=e.target.value!=="DELETE"}),i("#btnDeleteAllConfirm").addEventListener("click",async()=>{if(i("#deleteAllConfirmInput").value==="DELETE")try{await Fs(),y=[],S=null,p("#modalDeleteAll"),p("#modalSettings"),h("All data deleted","info",2e3),setTimeout(()=>{W("#viewOnboarding"),jt()},500)}catch(e){h("Failed to delete: "+e.message,"error")}})}async function Ys(){i("#currentPin").closest(".form-group").style.display="none",i("#newPin").placeholder="Create PIN",i("#confirmNewPin").placeholder="Confirm PIN",i("#changePinError").classList.remove("visible"),i("#btnChangePinConfirm").onclick,i("#btnChangePinConfirm").onclick=async()=>{const e=i("#newPin").value,t=i("#confirmNewPin").value,n=i("#changePinError");if(e.length<4){n.textContent="PIN must be at least 4 digits",n.classList.add("visible");return}if(e!==t){n.textContent="PINs do not match",n.classList.add("visible");return}try{const s=await tt(e);await J("pinData",s),await De(!0),b.pinEnabled=!0,S=e;const r=await Te();if(r){const o=JSON.stringify(r),a=await Pe(o,e);await J("vault",a)}p("#modalChangePin"),h("PIN protection enabled!","success"),Q(),setTimeout(()=>{i("#currentPin").closest(".form-group").style.display="block",i("#newPin").placeholder="",i("#confirmNewPin").placeholder=""},300)}catch(s){n.textContent="Failed: "+s.message,n.classList.add("visible")}},I("#modalChangePin")}function Zs(){K(".folder-chip[data-folder]").forEach(e=>{e.addEventListener("click",()=>{K(".folder-chip[data-folder]").forEach(t=>t.classList.remove("active")),e.classList.add("active"),X=e.dataset.folder,H(y)})}),i("#btnManageFolders").addEventListener("click",()=>{er()}),i("#closeModalFolders").addEventListener("click",()=>p("#modalManageFolders")),i("#closeModalMoveFolder").addEventListener("click",()=>p("#modalMoveToFolder")),i("#modalManageFolders").addEventListener("click",e=>{e.target===e.currentTarget&&p("#modalManageFolders")}),i("#modalMoveToFolder").addEventListener("click",e=>{e.target===e.currentTarget&&p("#modalMoveToFolder")}),i("#btnCreateFolder").addEventListener("click",async()=>{const e=i("#newFolderName").value.trim();if(!e){h("Please enter a folder name","error");return}const t=i("#folderColorPicker .color-swatch.active"),n=t?t.dataset.color:"#00E5FF";await as(e,n),i("#newFolderName").value="",await Jt(),await lt(),h("Folder created!","success")}),i("#folderColorPicker")?.addEventListener("click",e=>{e.target.classList.contains("color-swatch")&&(K("#folderColorPicker .color-swatch").forEach(t=>t.classList.remove("active")),e.target.classList.add("active"))})}async function Jt(){Gt=await me()}async function lt(){const e=i("#folderList");if(e){e.innerHTML="";for(const t of Gt){const n=document.createElement("button");n.className="folder-chip",n.dataset.folder=t.id,n.innerHTML=`
      <span style="width:8px;height:8px;border-radius:50%;background:${t.color};"></span>
      ${Z(t.name)}
    `,n.addEventListener("click",()=>{K(".folder-chip[data-folder]").forEach(s=>s.classList.remove("active")),n.classList.add("active"),X=t.id,H(y)}),e.appendChild(n)}}}async function er(){await qt(),I("#modalManageFolders")}async function qt(){const e=i("#foldersList"),t=await me();if(e.innerHTML="",t.length===0){e.innerHTML='<div style="text-align:center;color:var(--text-secondary);padding:20px;">No folders yet</div>';return}for(const n of t){const s=document.createElement("div");s.className="folder-item",s.innerHTML=`
      <div class="folder-dot" style="background:${n.color};"></div>
      <div class="folder-name">${Z(n.name)}</div>
      <div class="folder-actions">
        <button class="folder-btn delete" title="Delete folder">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
          </svg>
        </button>
      </div>
    `,s.querySelector(".folder-btn.delete").addEventListener("click",async()=>{confirm(`Delete folder "${n.name}"? Accounts will be uncategorized.`)&&(await cs(n.id),await qt(),await lt(),H(y),h("Folder deleted","info"))}),e.appendChild(s)}}async function tr(e){const t=i("#moveFolderList"),n=await me(),s=y.find(o=>o.id===e);t.innerHTML="";const r=document.createElement("div");r.className=`move-folder-item ${s?.folderId?"":"selected"}`,r.innerHTML=`
    <div style="width:24px;height:24px;border-radius:50%;background:var(--border-medium);display:flex;align-items:center;justify-content:center;">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
        <path d="M3 7v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2h-6l-2-2H5a2 2 0 0 0-2 2z"/>
      </svg>
    </div>
    <div style="flex:1;">Uncategorized</div>
  `,r.addEventListener("click",async()=>{await Lt(e,null),y=await C(),H(y),p("#modalMoveToFolder"),h("Account moved","success")}),t.appendChild(r);for(const o of n){const a=document.createElement("div");a.className=`move-folder-item ${s?.folderId===o.id?"selected":""}`,a.innerHTML=`
      <div style="width:24px;height:24px;border-radius:50%;background:${o.color};"></div>
      <div style="flex:1;">${Z(o.name)}</div>
    `,a.addEventListener("click",async()=>{await Lt(e,o.id),y=await C(),H(y),p("#modalMoveToFolder"),h("Account moved","success")}),t.appendChild(a)}I("#modalMoveToFolder")}async function nr(){jt(),Bs(),Os(),Rs(),Vs(),js(),Ws(),Qs(),Js(),Zs();const e=await os(),t=await rt(),n=await ss(),s=await rs();e?W("#viewOnboarding"):t&&n&&!s?W("#viewLock"):(S=null,s||await Me(null),W("#viewMain"),await Fe(),n&&ct()),chrome.storage.session.get("pendingQR",async r=>{if(r.pendingQR){chrome.storage.session.remove("pendingQR");const o=ts(r.pendingQR);_s(o),I("#modalAddAccount")}})}nr().catch(console.error);
